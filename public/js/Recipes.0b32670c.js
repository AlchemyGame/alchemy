(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["Recipes"],{ffc0:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("b-container",[a("b-row",{staticClass:"mb-3"},[a("b-col",{attrs:{cols:"4"}},[a("b-input-group",[a("b-form-input",{attrs:{placeholder:"Search element"},model:{value:e.data.table.search,callback:function(t){e.$set(e.data.table,"search",t)},expression:"data.table.search"}}),a("b-input-group-append",[a("b-btn",{attrs:{disabled:!e.data.table.search},on:{click:function(t){e.data.table.search=null}}},[e._v("Clear")])],1)],1)],1),a("b-col",{attrs:{cols:"4",sm:"3",md:"2",lg:"2",xl:"2"}},[a("b-btn",{staticClass:"mb-3",attrs:{variant:"success"},on:{click:function(t){return e.createRecipeModalShow()}}},[e._v("Create recipe")])],1),a("b-col",{attrs:{cols:"4",sm:"3",md:"2",lg:"2",xl:"2","offset-md":"4"}},[a("b-form-select",{attrs:{options:e.data.table.pagination.pageOptions},model:{value:e.data.table.pagination.perPage,callback:function(t){e.$set(e.data.table.pagination,"perPage",t)},expression:"data.table.pagination.perPage"}})],1)],1),a("b-row",[a("b-col",{attrs:{cols:"12"}},[e.data.table.loading?a("loading-spinner",{attrs:{size:"large"}}):e._e(),e.data.table.error?a("b-row",{staticClass:"justify-content-md-center"},[a("b-col",{staticClass:"error",attrs:{cols:"12",md:"auto"}},[a("b-alert",{attrs:{show:"",variant:"danger"}},[e._v(e._s(e.data.table.error))])],1)],1):e._e(),e.data.table.loading||e.data.table.error?e._e():a("b-table",{attrs:{"show-empty":"",responsive:"",hover:"",flex:"",items:e.data.recipes,fields:e.data.table.fields,"current-page":e.data.table.pagination.currentPage,"per-page":e.data.table.pagination.perPage,filter:e.data.table.search},scopedSlots:e._u([{key:"recipe",fn:function(t){return e._l(t.item.recipe,function(t,r){return a("a",[e._v(" "+e._s(t.name))])})}},{key:"action",fn:function(t){return[a("b-button-group",{attrs:{size:"sm"}},[a("b-btn",{staticClass:"mr-1",attrs:{variant:"warning",size:"sm"},on:{click:function(a){return e.editRecipeModalShow(t)}}},[a("font-awesome-icon",{attrs:{icon:"edit"}})],1),a("b-btn",{attrs:{variant:"danger",size:"sm"},on:{click:function(a){return e.deleteRecipeModalShow(t)}}},[a("font-awesome-icon",{attrs:{icon:"trash"}})],1)],1)]}}],null,!1,2817985998)}),a("b-pagination",{attrs:{align:"center","total-rows":e.data.table.totalRows,"per-page":e.data.table.pagination.perPage},model:{value:e.data.table.pagination.currentPage,callback:function(t){e.$set(e.data.table.pagination,"currentPage",t)},expression:"data.table.pagination.currentPage"}})],1)],1),a("b-modal",{ref:"createRecipeModal",attrs:{title:"Create new recipe",size:"xl","hide-header-close":"","no-close-on-backdrop":"","no-close-on-esc":"","ok-title":"Create","ok-variant":"success","cancel-variant":"danger"},on:{show:function(t){return e.createRecipeModalShow()},ok:function(t){return e.createRecipe()},cancel:function(t){return e.createRecipeModalHide()}}},[e.data.create.loading?a("loading-spinner",{attrs:{size:"large"}}):e._e(),e.data.create.error?a("b-row",{staticClass:"justify-content-md-center"},[a("b-col",{staticClass:"error",attrs:{cols:"12",md:"auto"}},[a("b-alert",{attrs:{show:"",variant:"danger"}},[e._v(e._s(e.data.create.error))])],1)],1):e._e(),e.data.create.loading||e.data.create.error?e._e():a("b-row",[a("b-col",{attrs:{md:"4"}},[a("b-row",[a("b-col",{attrs:{md:"12"}},[a("b-form-group",{attrs:{label:"Result element","label-for":"createRecipeResult"}},[a("v-select",{attrs:{id:"createRecipeResult",options:e.data.elements,label:"name"},model:{value:e.data.create.result,callback:function(t){e.$set(e.data.create,"result",t)},expression:"data.create.result"}})],1)],1)],1),e.data.create.dropdownsCount?e._l(e.data.create.dropdownsCount,function(t,r){return a("b-row",{key:t,staticClass:"mt-2"},[a("b-col",{attrs:{md:"12"}},[a("b-form-group",{attrs:{"label-for":"createRecipeElements"}},[e._v("Element "+e._s(r+1)),a("v-select",{staticClass:"mt-1",attrs:{id:"createRecipeElements",options:e.data.elements,label:"name"},on:{input:function(t){return e.createRecipeCheckNewDropdown(e.data.create.recipe[r],r)}},model:{value:e.data.create.recipe[r],callback:function(t){e.$set(e.data.create.recipe,r,t)},expression:"data.create.recipe[index]"}})],1)],1)],1)}):e._e()],2),a("b-col",{attrs:{md:"8"}},[a("b-card",{attrs:{"no-body":""}},[a("b-tabs",{attrs:{card:"",pills:"",vertical:"",small:"","nav-wrapper-class":"w-25"}},e._l(e.data.categories,function(t){return a("b-tab",{key:t._id,attrs:{title:t.name}},e._l(e.data.elements,function(r){return r.category===t.name?a("b-btn",{key:r._id,staticClass:"mr-2 mb-2",attrs:{size:"sm",variant:"outline-success"},on:{click:function(t){return e.data.create.recipe.push(r)}}},[e._v(e._s(r.name))]):e._e()}),1)}),1)],1)],1)],1)],1),a("b-modal",{ref:"editRecipeModal",attrs:{title:"Edit recipe",size:"xl","hide-header-close":"","no-close-on-backdrop":"","no-close-on-esc":"","ok-title":"Save","ok-variant":"success","cancel-variant":"danger"},on:{ok:function(t){return e.editRecipe()},cancel:function(t){return e.editRecipeModalHide()}}},[e.data.edit.loading?a("loading-spinner",{attrs:{size:"large"}}):e._e(),e.data.edit.error?a("b-row",{staticClass:"justify-content-md-center"},[a("b-col",{staticClass:"error",attrs:{cols:"12",md:"auto"}},[a("b-alert",{attrs:{show:"",variant:"danger"}},[e._v(e._s(e.data.edit.error))])],1)],1):e._e(),e.data.edit.loading||e.data.edit.error?e._e():a("b-row",[a("b-col",{attrs:{md:"4"}},[a("b-row",[a("b-col",{attrs:{md:"12"}},[a("b-form-group",{attrs:{label:"Result element","label-for":"editRecipeResult"}},[a("v-select",{attrs:{id:"editRecipeResult",options:e.data.elements,label:"name"},model:{value:e.data.edit.result,callback:function(t){e.$set(e.data.edit,"result",t)},expression:"data.edit.result"}})],1)],1)],1),e.data.edit.dropdownsCount?e._l(e.data.edit.dropdownsCount,function(t,r){return a("b-row",{key:t,staticClass:"mt-2"},[a("b-col",{attrs:{md:"12"}},[a("b-form-group",{attrs:{"label-for":"editRecipeElements"}},[e._v("Element "+e._s(r+1)),a("v-select",{staticClass:"mt-1",attrs:{id:"editRecipeElements",options:e.data.elements,label:"name"},on:{input:function(t){return e.editRecipeCheckNewDropdown(e.data.edit.recipe[r],r)}},model:{value:e.data.edit.recipe[r],callback:function(t){e.$set(e.data.edit.recipe,r,t)},expression:"data.edit.recipe[index]"}})],1)],1)],1)}):e._e()],2),a("b-col",{attrs:{md:"8"}},[a("b-card",{attrs:{"no-body":""}},[a("b-tabs",{attrs:{card:"",pills:"",vertical:"",small:"","nav-wrapper-class":"w-25"}},e._l(e.data.categories,function(t){return a("b-tab",{key:t._id,attrs:{title:t.name}},e._l(e.data.elements,function(r){return r.category===t.name?a("b-btn",{key:r._id,staticClass:"mr-2 mb-2",attrs:{size:"sm",variant:"outline-success"},on:{click:function(t){return e.data.edit.recipe.push(r)}}},[e._v(e._s(r.name))]):e._e()}),1)}),1)],1)],1)],1)],1),a("b-modal",{ref:"deleteRecipeModal",attrs:{size:"md","hide-header-close":"","no-close-on-backdrop":"","no-close-on-esc":"","ok-title":"Delete","ok-variant":"success","cancel-variant":"danger","hide-header":""},on:{ok:function(t){return e.deleteRecipe()},cancel:function(t){return e.deleteRecipeModalHide()}}},[a("b-row",{staticClass:"justify-content-md-center"},[a("b-col",{attrs:{cols:"12",md:"auto"}},[a("h4",[e._v("Delete recipe"),a("strong",{staticClass:"text-danger"},[e._v(" "+e._s(e.data.delete.name))]),e._v("?")])])],1)],1)],1)},i=[],n=(a("7f7f"),a("970e")),s={name:"Recipes",created:function(){this.getRecipes()},watch:{$route:"getRecipes"},data:function(){return{data:{elements:[],categories:[],recipes:[],table:{totalRows:0,loading:!1,error:null,fields:[{key:"result.name",label:"Element",class:"align-middle text-center",sortable:!0},{key:"recipe",label:"Recipe",class:"align-middle text-center",sortable:!0},{key:"action",label:"Action",class:"align-middle text-center",sortable:!1}],pagination:{perPage:10,currentPage:1,pageOptions:[5,10,25,50]},search:null},create:{loading:!1,error:null,dropdownsCount:2,recipe:[],result:null},delete:{loading:!1,error:null,recipeId:null,name:null},edit:{loading:!1,error:null,dropdownsCount:2,recipeId:null,recipe:[],result:null}}}},methods:{getElements:function(){var e=this;this.data.table.loading=!0,Object(n["d"])().then(function(t){e.data.table.loading=!1,200===t.status?(e.data.elements=t.data.response,e.data.create.error=null,e.data.edit.error=null):(e.data.create.error=t.data,e.data.edit.error=t.data)})},getCategories:function(){var e=this;Object(n["c"])().then(function(t){e.data.create.loading=!1,200===t.status?(e.data.categories=t.data.response,e.data.create.error=null,e.data.edit.error=null):(e.data.create.error=t.data,e.data.edit.error=t.data)})},getRecipes:function(){var e=this;this.data.table.loading=!0,Object(n["e"])().then(function(t){e.data.table.loading=!1,200===t.status?(e.data.recipes=t.data.response,e.data.table.totalRows=e.data.recipes.length,e.data.table.error=null):e.data.table.error=t.data})},onTableSearch:function(e){this.data.table.totalRows=e.length,this.data.table.pagination.currentPage=1},createRecipeCheckNewDropdown:function(e,t){e&&t===this.data.create.dropdownsCount-1?this.data.create.dropdownsCount++:e||t===this.data.create.dropdownsCount-1||(this.data.create.recipe=this.data.create.recipe.filter(function(e){return e}),this.data.create.dropdownsCount--)},editRecipeCheckNewDropdown:function(e,t){e&&t===this.data.edit.dropdownsCount-1?this.data.edit.dropdownsCount++:e||t===this.data.edit.dropdownsCount-1||(this.data.edit.recipe=this.data.edit.recipe.filter(function(e){return e}),this.data.edit.dropdownsCount--)},createRecipe:function(e){var t=this;if(this.data.create.result&&this.data.create.recipe){for(var a=[],r=0;r<this.data.create.recipe.length;r++)a.push(this.data.create.recipe[r]._id);this.data.create.loading=!0,Object(n["h"])(a,this.data.create.result._id).then(function(e){t.data.create.loading=!1,201===e.status?(t.getRecipes(),t.createRecipeModalHide(),t.data.create.error=null):t.data.create.error=e.data})}else e.preventDefault()},editRecipe:function(e){var t=this;if(this.data.edit.recipeId&&this.data.edit.result&&this.data.edit.recipe){for(var a=[],r=0;r<this.data.edit.recipe.length;r++)a.push(this.data.edit.recipe[r]._id);this.data.edit.loading=!0,Object(n["j"])(a,this.data.edit.result._id,this.data.edit.recipeId).then(function(e){t.data.edit.loading=!1,200===e.status?(t.getRecipes(),t.editRecipeModalHide(),t.data.edit.error=null):t.data.edit.error=e.data})}else e.preventDefault()},deleteRecipe:function(e){var t=this;this.data.delete.loading=!0,Object(n["b"])(this.data.delete.recipeId).then(function(e){t.data.delete.loading=!1,200===e.status?(t.getRecipes(),t.data.delete.error=null):t.data.delete.error=e.data})},createRecipeModalShow:function(){this.$refs.createRecipeModal.show(),this.getElements(),this.getCategories()},editRecipeModalShow:function(e){this.data.edit.recipeId=e.item._id,this.data.edit.recipe=e.item.recipe,this.data.edit.result=e.item.result,this.data.edit.dropdownsCount=e.item.recipe.length,this.$refs.editRecipeModal.show(),this.getElements(),this.getCategories()},deleteRecipeModalShow:function(e){this.$refs.deleteRecipeModal.show(),this.data.delete.recipeId=e.item._id,this.data.delete.name=e.item.result.name},createRecipeModalHide:function(){this.$refs.createRecipeModal.hide(),this.data.create.recipe=[],this.data.create.result=null,this.data.create.dropdownsCount=2},editRecipeModalHide:function(){this.$refs.editRecipeModal.hide()},deleteRecipeModalHide:function(){this.$refs.deleteRecipeModal.hide()}}},o=s,d=a("2877"),l=Object(d["a"])(o,r,i,!1,null,null,null);t["default"]=l.exports}}]);
//# sourceMappingURL=Recipes.0b32670c.js.map