(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["Game"],{"001c":function(e,t,n){"use strict";n.r(t);var s=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("section",{staticClass:"section-game"},[n("section",{staticClass:"section-categories"},[n("CategoriesList")],1),n("section",{staticClass:"section-game-board"},[e._l(e.activeElements,(function(e){return n("ActiveElement",{key:e.gameId,attrs:{elementData:e}})})),n("div",{staticClass:"control-panel"},[n("ActiveElementsHistory",{directives:[{name:"show",rawName:"v-show",value:e.history.last.firstElement,expression:"history.last.firstElement"}]}),n("ClearGameField")],1)],2),n("section",{staticClass:"section-opened-elements"},[n("OpenedElementsList",e._l(e.filteredOpenedElements,(function(e){return n("OpenedElement",{key:e._id,attrs:{elementData:e}})})),1)],1)])},r=[],i=n("2f62"),a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("transition",{attrs:{name:"fade"}},[n("vue-draggable-resizable",{class:{"fail-combine":e.elementDropped},attrs:{"class-name":"active-element",resizable:!1,"disable-user-select":!0,w:100,h:100,x:e.elementData.x,y:e.elementData.y,z:e.elementData.z,parent:!0,onDragStart:e.onDragStart},on:{activated:e.onActivated,dragstop:e.onDragstop,deactivated:e.onDeactivated}},[n("div",{staticClass:"data"},[n("b-img",{attrs:{src:e.elementIcon,width:"45",height:"45",alt:e.elementData.name},on:{error:e.setBaseIcon}}),n("span",[e._v(e._s(e.elementData.name))])],1)])],1)},o=[];function c(e,t){if(t.length<2)return{};var n={},s=50,r=25;return t.forEach((function(t){var i=Math.abs(e.x-t.x),a=Math.abs(e.y-t.y);i<=s&&a<=r&&e.gameId!==t.gameId&&(s=i,r=a,n=t)})),n}function l(e,t,n){var s=n.filter((function(n){return e._id===n.recipe[0]._id&&t._id===n.recipe[1]._id||t._id===n.recipe[0]._id&&e._id===n.recipe[1]._id}));return s.length>0?s[0]:null}function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,s)}return n}function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(n,!0).forEach((function(t){u(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var p={props:{elementData:{value:Object,required:!0,default:{}}},computed:m({},Object(i["c"])({activeElements:"elements/activeElements",selectedElement:"elements/selectedElement",openedRecipes:"recipes/openedRecipes",recipes:"recipes/recipes",state:"elements/state"}),{elementIcon:function(){return"/images/elements/".concat(this.elementData.name,".png")}}),data:function(){return{elementDropped:!1}},methods:m({},Object(i["b"])({addActiveElement:"elements/addActiveElement",deleteActiveElement:"elements/deleteActiveElement",setSelectedElement:"elements/setSelectedElement",setSelectedElementCoordinates:"elements/setSelectedElementCoordinates",deleteSelectedElement:"elements/deleteSelectedElement",addOpenedRecipe:"recipes/addOpenedRecipe",addHistory:"game/addHistory",addOpenedElement:"elements/addOpenedElement"}),{onActivated:function(){this.setSelectedElement(this.elementData)},onDeactivated:function(){this.setSelectedElementCoordinates({x:this.elementData.x,y:this.elementData.y,z:100}),this.deleteSelectedElement(),this.elementDropped=!1},onDragStart:function(){this.elementDropped&&(this.elementDropped=!1),this.setSelectedElement(this.elementData),this.setSelectedElementCoordinates({x:this.elementData.x,y:this.elementData.y,z:101})},onDragstop:function(e,t){var n=this;if(this.selectedElement){this.setSelectedElementCoordinates({x:e,y:t,z:101});var s=c(this.selectedElement,this.activeElements);if(s.gameId){var r=l(this.selectedElement,s,this.recipes);if(r){var i=this.openedRecipes.filter((function(e){return r._id===e._id}));0===i.length&&this.addOpenedElement(r.result).then((function(e){n.state.error||n.addOpenedRecipe(r)}));var a=m({},r.result,{x:e,y:t});this.addActiveElement(a),this.addHistory({firstElement:this.selectedElement.name,secondElement:s.name,result:r.result.name}),this.deleteActiveElement(this.selectedElement),this.deleteActiveElement(s)}else this.elementDropped=!0,this.addHistory({firstElement:this.selectedElement.name,secondElement:s.name,result:""})}}},setBaseIcon:function(e){e.target.src="/images/elements/Base.png"}})},f=p,g=(n("57cc"),n("2877")),h=Object(g["a"])(f,a,o,!1,null,"c6a1e302",null),b=h.exports,O=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("vue-draggable-resizable",{attrs:{"class-name":"element",draggable:!0,"disable-user-select":!0,"drag-handle":".element-image",resizable:!1,minHeight:64,maxHeight:64,w:e.width,h:64,x:e.elementData.x,y:e.elementData.y,z:e.elementData.z,onDragStart:e.onDragStart},on:{activated:e.onActivated,dragstop:e.onDragstop}},[n("div",{staticClass:"data"},[n("b-img",{staticClass:"element-image",attrs:{src:e.elementIcon,width:"64",height:"64",alt:e.elementData.name},on:{error:e.setBaseIcon}}),n("span",{class:{hidden:e.isDragging}},[e._v(e._s(e.elementData.name))])],1)])},v=[];function y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,s)}return n}function E(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?y(n,!0).forEach((function(t){w(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function w(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var j={props:{elementData:{value:Object,required:!0,default:{}}},computed:E({},Object(i["c"])({gameFieldSize:"game/gameFieldSize",selectedElement:"elements/selectedElement",activeElements:"elements/activeElements"}),{elementIcon:function(){return"/images/elements/".concat(this.elementData.name,".png")}}),mounted:function(){var e=this;this.width=document.getElementsByClassName("opened-elements-list")[0].clientWidth,window.addEventListener("resize",(function(t){e.width=document.getElementsByClassName("opened-elements-list")[0].clientWidth}))},data:function(){return{width:100,isDragging:!1,elementDropped:!1}},methods:E({},Object(i["b"])({addActiveElement:"elements/addActiveElement",setSelectedElement:"elements/setSelectedElement",setSelectedElementCoordinates:"elements/setSelectedElementCoordinates",deleteSelectedElement:"elements/deleteSelectedElement",updateOpenedElementsPositions:"elements/updateOpenedElementsPositions"}),{onActivated:function(){this.isDragging=!0},onDeactivated:function(){this.deleteSelectedElement()},onDragStart:function(){this.setSelectedElement(this.elementData),this.setSelectedElementCoordinates({x:this.elementData.x,y:this.elementData.y,z:101})},onDragstop:function(e,t){var n=this;if(this.isDragging=!1,this.setSelectedElementCoordinates({x:e,y:t,z:100}),e<-100){var s=this.gameFieldSize.x-Math.abs(this.selectedElement.x),r=this.selectedElement.y;s<0&&(s=0),r<0?r=0:r>this.gameFieldSize.y-100&&(r=this.gameFieldSize.y-100),this.setSelectedElementCoordinates({x:s,y:r,z:100}),this.addActiveElement(this.selectedElement),this.$nextTick((function(){var e=document.getElementsByClassName("active-element")[document.getElementsByClassName("active-element").length-1];e.dispatchEvent(new Event("mousedown")),e.dispatchEvent(new Event("mouseup"))}))}this.deleteSelectedElement(),this.$nextTick((function(){n.updateOpenedElementsPositions()}))},setBaseIcon:function(e){e.target.src="/images/elements/Base.png"}})},P=j,C=(n("4c20"),Object(g["a"])(P,O,v,!1,null,"161fb723",null)),D=C.exports,S=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"clear-game-field-button"},[n("font-awesome-icon",{staticClass:"clear-game-field-button",attrs:{id:"clear-game-field-button",icon:"trash"},on:{click:e.onClick}}),n("b-popover",{attrs:{target:"clear-game-field-button",placement:"bottom",content:"Click for clear game field",show:e.showPopover},on:{shown:e.onShown}})],1)},_=[];function x(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,s)}return n}function A(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?x(n,!0).forEach((function(t){z(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):x(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function z(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var k={data:function(){return{showPopover:!1,isTimeout:!1}},methods:A({},Object(i["b"])({removeAllActiveElements:"elements/deleteActiveElements"}),{onClick:function(){var e=this;this.showPopover||this.isTimeout?this.showPopover&&this.isTimeout&&setTimeout((function(){e.isTimeout=!1,e.showPopover=!1,e.removeAllActiveElements()}),0):this.showPopover=!0},onShown:function(){var e=this;this.isTimeout||(this.isTimeout=!0,setTimeout((function(){e.isTimeout=!1,e.showPopover=!1}),1500))}})},B=k,R=(n("64b6"),Object(g["a"])(B,S,_,!1,null,"c31eea60",null)),I=R.exports,T=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"categories-list"},[e.state.isLoading&&!e.state.error?n("div",{staticClass:"loading"},[n("b-spinner",{staticClass:"spinner"})],1):e._e(),e.state.error&&!e.state.isLoading?n("div",{staticClass:"error"},[n("div",{staticClass:"error"},[e._v(" "+e._s(e.state.error)+" ")])]):e._e(),e._l(e.openedCategories,(function(t){return n("button",{key:t._id,staticClass:"select-category-button",class:{active:t._id===e.selectedCategory._id},on:{click:function(n){return e.selectCategory(t)}}},[e._v(" "+e._s(t.name)+" ")])}))],2)},F=[];function H(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,s)}return n}function L(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?H(n,!0).forEach((function(t){$(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):H(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function $(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var N={computed:L({},Object(i["c"])({state:"categories/state",selectedCategory:"categories/selectedCategory",openedCategories:"categories/openedCategories"})),methods:L({},Object(i["b"])({setSelectedCategory:"categories/setSelectedCategory",updateOpenedElementsByCategory:"elements/updateOpenedElementsByCategory",updateOpenedElementsPositions:"elements/updateOpenedElementsPositions"}),{selectCategory:function(e){var t=this;this.setSelectedCategory(e),this.updateOpenedElementsByCategory(e),this.$nextTick((function(){t.updateOpenedElementsPositions()}))}})},G=N,M=(n("14f7"),Object(g["a"])(G,T,F,!1,null,"4966bcdb",null)),q=M.exports,J=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"opened-elements-list"},[0===e.openedCategories.length&&e.state.isLoading&&!e.state.error?n("div",{staticClass:"loading"},[n("b-spinner",{staticClass:"spinner"})],1):e._e(),0===e.openedCategories.length&&e.state.error&&!e.state.isLoading?n("div",{staticClass:"error"},[n("div",{staticClass:"error"},[e._v(" "+e._s(e.state.error)+" ")])]):e._e(),e._t("default")],2)},W=[];function K(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,s)}return n}function Q(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?K(n,!0).forEach((function(t){U(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):K(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function U(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var V={computed:Q({},Object(i["c"])({state:"elements/state",openedCategories:"categories/openedCategories"}))},X=V,Y=(n("a621"),Object(g["a"])(X,J,W,!1,null,"e572e6f8",null)),Z=Y.exports,ee=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"active-elements-history",on:{click:e.showHistory}},[n("span",{directives:[{name:"show",rawName:"v-show",value:e.history.last.firstElement&&e.history.last.secondElement,expression:"history.last.firstElement && history.last.secondElement"}]},[e._v(e._s(e.history.last.firstElement)+" + "+e._s(e.history.last.secondElement))]),n("span",{directives:[{name:"show",rawName:"v-show",value:e.history.last.result,expression:"history.last.result"}]},[e._v(" = "+e._s(e.history.last.result))])])},te=[];function ne(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,s)}return n}function se(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ne(n,!0).forEach((function(t){re(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ne(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function re(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ie={computed:se({},Object(i["c"])({history:"game/history"})),methods:{showHistory:function(){var e=[];this.history.past.forEach((function(t){e.push("".concat(t.firstElement," + ").concat(t.secondElement," = ").concat(t.result))})),e.forEach((function(e){}))}}},ae=ie,oe=(n("8bab"),Object(g["a"])(ae,ee,te,!1,null,"493e56d2",null)),ce=oe.exports;function le(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,s)}return n}function de(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?le(n,!0).forEach((function(t){me(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):le(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function me(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ue={components:{ActiveElement:b,OpenedElement:D,CategoriesList:q,OpenedElementsList:Z,ClearGameField:I,ActiveElementsHistory:ce},mounted:function(){var e=this,t=document.getElementsByClassName("section-game-board");this.setGameFieldSize(t),window.addEventListener("resize",(function(n){e.setGameFieldSize(t)})),this.getOpenedElements().then((function(){e.getOpenedCategories(e.openedElements).then((function(){e.setSelectedCategory(e.openedCategories[0]),e.updateOpenedElementsByCategory(e.openedCategories[0]),e.updateOpenedElementsPositions()})),e.getRecipes().then((function(){e.findOpenedRecipes()}))}))},computed:de({},Object(i["c"])({openedElements:"elements/openedElements",activeElements:"elements/activeElements",openedCategories:"categories/openedCategories",recipes:"recipes/recipes",selectedCategory:"categories/selectedCategory",history:"game/history"}),{filteredOpenedElements:function(){return this.openedElements.filter((function(e){if(e.show)return e}))}}),methods:de({},Object(i["b"])({setGameFieldSize:"game/setGameFieldSize",getOpenedElements:"elements/getOpenedElements",setActiveElements:"elements/setActiveElements",getOpenedCategories:"categories/getOpenedCategories",setSelectedCategory:"categories/setSelectedCategory",updateOpenedElementsPositions:"elements/updateOpenedElementsPositions",setOpenedRecipes:"recipes/setOpenedRecipes",getRecipes:"recipes/getRecipes",updateOpenedElementsByCategory:"elements/updateOpenedElementsByCategory",updateActiveElementsPositions:"elements/updateActiveElementsPositions"}),{findOpenedRecipes:function(){var e=this,t=[];this.recipes.forEach((function(n){var s=e.openedElements.filter((function(e){return n.recipe[0]._id===e._id})),r=e.openedElements.filter((function(e){return n.recipe[1]._id===e._id})),i=e.openedElements.filter((function(e){return n.result._id===e._id}));s.length>0&&r.length>0&&i.length>0&&t.push(n)})),this.setOpenedRecipes(t)}})},pe=ue,fe=(n("03a4"),Object(g["a"])(pe,s,r,!1,null,"1da894a1",null));t["default"]=fe.exports},"03a4":function(e,t,n){"use strict";var s=n("18c0"),r=n.n(s);r.a},"0b2e":function(e,t,n){},"14f7":function(e,t,n){"use strict";var s=n("e9e2"),r=n.n(s);r.a},"18c0":function(e,t,n){},"4c20":function(e,t,n){"use strict";var s=n("c63d"),r=n.n(s);r.a},5209:function(e,t,n){},"57cc":function(e,t,n){"use strict";var s=n("7ae8"),r=n.n(s);r.a},"64b6":function(e,t,n){"use strict";var s=n("0b2e"),r=n.n(s);r.a},"7ae8":function(e,t,n){},"8bab":function(e,t,n){"use strict";var s=n("8fed"),r=n.n(s);r.a},"8fed":function(e,t,n){},a621:function(e,t,n){"use strict";var s=n("5209"),r=n.n(s);r.a},c63d:function(e,t,n){},e9e2:function(e,t,n){}}]);
//# sourceMappingURL=Game-legacy.f5178408.js.map