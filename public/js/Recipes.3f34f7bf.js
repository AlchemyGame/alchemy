(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["Recipes"],{"3f27":function(e,t,a){"use strict";a.d(t,"b",function(){return s}),a.d(t,"c",function(){return d}),a.d(t,"d",function(){return l}),a.d(t,"a",function(){return p});var r=a("1da1"),i=a("bc3a"),n=a.n(i);function s(){return o.apply(this,arguments)}function o(){return o=Object(r["a"])(function*(){try{const t=yield n.a.get("/api/elements");return t}catch(e){return e.response}}),o.apply(this,arguments)}function d(e,t){return c.apply(this,arguments)}function c(){return c=Object(r["a"])(function*(e,t){try{const r=yield n()({method:"post",url:"/api/element/add",data:{name:e,category:t}});return r}catch(a){return a.response}}),c.apply(this,arguments)}function l(e,t,a){return u.apply(this,arguments)}function u(){return u=Object(r["a"])(function*(e,t,a){try{const i=yield n()({method:"put",url:"/api/element/update",data:{elementId:e,newName:t,newCategory:a}});return i}catch(r){return r.response}}),u.apply(this,arguments)}function p(e){return h.apply(this,arguments)}function h(){return h=Object(r["a"])(function*(e){try{const a=yield n()({method:"delete",url:"/api/element/delete",data:{elementId:e}});return a}catch(t){return t.response}}),h.apply(this,arguments)}},"63c6":function(e,t,a){"use strict";a.d(t,"a",function(){return s}),a.d(t,"b",function(){return d});var r=a("1da1"),i=a("bc3a"),n=a.n(i);function s(){return o.apply(this,arguments)}function o(){return o=Object(r["a"])(function*(){try{const t=yield n.a.get("/api/categories");return t}catch(e){return e.response}}),o.apply(this,arguments)}function d(e){return c.apply(this,arguments)}function c(){return c=Object(r["a"])(function*(e){try{const a=yield n()({method:"post",url:"/api/category/add",data:{name:e}});return a}catch(t){return t.response}}),c.apply(this,arguments)}},ffc0:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("b-container",[a("b-row",{staticClass:"mb-3"},[a("b-col",{attrs:{cols:"4"}},[a("b-input-group",[a("b-form-input",{attrs:{placeholder:"Search element"},model:{value:e.data.table.search,callback:function(t){e.$set(e.data.table,"search",t)},expression:"data.table.search"}}),a("b-input-group-append",[a("b-btn",{attrs:{disabled:!e.data.table.search},on:{click:function(t){e.data.table.search=null}}},[e._v("Clear")])],1)],1)],1),a("b-col",{attrs:{cols:"4",sm:"3",md:"2",lg:"2",xl:"2"}},[a("b-btn",{staticClass:"mb-3",attrs:{variant:"success"},on:{click:function(t){return e.createRecipeModalShow()}}},[e._v("Create recipe")])],1),a("b-col",{attrs:{cols:"4",sm:"3",md:"2",lg:"2",xl:"2","offset-md":"4"}},[a("b-form-select",{attrs:{options:e.data.table.pagination.pageOptions},model:{value:e.data.table.pagination.perPage,callback:function(t){e.$set(e.data.table.pagination,"perPage",t)},expression:"data.table.pagination.perPage"}})],1)],1),a("b-row",[a("b-col",{attrs:{cols:"12"}},[e.data.table.loading?a("loading-spinner",{attrs:{size:"large"}}):e._e(),e.data.table.error?a("b-row",{staticClass:"justify-content-md-center"},[a("b-col",{staticClass:"error",attrs:{cols:"12",md:"auto"}},[a("b-alert",{attrs:{show:"",variant:"danger"}},[e._v(e._s(e.data.table.error))])],1)],1):e._e(),e.data.table.loading||e.data.table.error?e._e():a("b-table",{attrs:{"show-empty":"",responsive:"",hover:"",flex:"",items:e.data.recipes,fields:e.data.table.fields,"current-page":e.data.table.pagination.currentPage,"per-page":e.data.table.pagination.perPage,filter:e.data.table.search},scopedSlots:e._u([{key:"recipe",fn:function(t){return e._l(t.item.recipe,function(t,r){return a("a",[e._v(" "+e._s(t.name))])})}},{key:"action",fn:function(t){return[a("b-button-group",{attrs:{size:"sm"}},[a("b-btn",{staticClass:"mr-1",attrs:{variant:"warning",size:"sm"},on:{click:function(a){return e.editRecipeModalShow(t)}}},[a("font-awesome-icon",{attrs:{icon:"edit"}})],1),a("b-btn",{attrs:{variant:"danger",size:"sm"},on:{click:function(a){return e.deleteRecipeModalShow(t)}}},[a("font-awesome-icon",{attrs:{icon:"trash"}})],1)],1)]}}],null,!1,2817985998)}),a("b-pagination",{attrs:{align:"center","total-rows":e.data.table.totalRows,"per-page":e.data.table.pagination.perPage},model:{value:e.data.table.pagination.currentPage,callback:function(t){e.$set(e.data.table.pagination,"currentPage",t)},expression:"data.table.pagination.currentPage"}})],1)],1),a("b-modal",{ref:"createRecipeModal",attrs:{title:"Create new recipe",size:"xl","hide-header-close":"","no-close-on-backdrop":"","no-close-on-esc":"","ok-title":"Create","ok-variant":"success","cancel-variant":"danger"},on:{show:function(t){return e.createRecipeModalShow()},ok:function(t){return e.createRecipe()},cancel:function(t){return e.createRecipeModalHide()}}},[e.data.create.loading?a("loading-spinner",{attrs:{size:"large"}}):e._e(),e.data.create.error?a("b-row",{staticClass:"justify-content-md-center"},[a("b-col",{staticClass:"error",attrs:{cols:"12",md:"auto"}},[a("b-alert",{attrs:{show:"",variant:"danger"}},[e._v(e._s(e.data.create.error))])],1)],1):e._e(),e.data.create.loading||e.data.create.error?e._e():a("b-row",[a("b-col",{attrs:{md:"4"}},[a("b-row",[a("b-col",{attrs:{md:"12"}},[a("b-form-group",{attrs:{label:"Result element","label-for":"createRecipeResult"}},[a("v-select",{attrs:{id:"createRecipeResult",options:e.data.elements,label:"name"},model:{value:e.data.create.result,callback:function(t){e.$set(e.data.create,"result",t)},expression:"data.create.result"}})],1)],1)],1),e.data.create.dropdownsCount?e._l(e.data.create.dropdownsCount,function(t,r){return a("b-row",{key:t,staticClass:"mt-2"},[a("b-col",{attrs:{md:"12"}},[a("b-form-group",{attrs:{"label-for":"createRecipeElements"}},[e._v("Element "+e._s(r+1)),a("v-select",{staticClass:"mt-1",attrs:{id:"createRecipeElements",options:e.data.elements,label:"name"},on:{input:function(t){return e.createRecipeCheckNewDropdown(e.data.create.recipe[r],r)}},model:{value:e.data.create.recipe[r],callback:function(t){e.$set(e.data.create.recipe,r,t)},expression:"data.create.recipe[index]"}})],1)],1)],1)}):e._e()],2),a("b-col",{attrs:{md:"8"}},[a("b-card",{attrs:{"no-body":""}},[a("b-tabs",{attrs:{card:"",pills:"",vertical:"",small:"","nav-wrapper-class":"w-25"}},e._l(e.data.categories,function(t){return a("b-tab",{key:t._id,attrs:{title:t.name}},e._l(e.data.elements,function(r){return r.category===t.name?a("b-btn",{key:r._id,staticClass:"mr-2 mb-2",attrs:{size:"sm",variant:"outline-success"},on:{click:function(t){return e.data.create.recipe.push(r)}}},[e._v(e._s(r.name))]):e._e()}),1)}),1)],1)],1)],1)],1),a("b-modal",{ref:"editRecipeModal",attrs:{title:"Edit recipe",size:"xl","hide-header-close":"","no-close-on-backdrop":"","no-close-on-esc":"","ok-title":"Save","ok-variant":"success","cancel-variant":"danger"},on:{ok:function(t){return e.editRecipe()},cancel:function(t){return e.editRecipeModalHide()}}},[e.data.edit.loading?a("loading-spinner",{attrs:{size:"large"}}):e._e(),e.data.edit.error?a("b-row",{staticClass:"justify-content-md-center"},[a("b-col",{staticClass:"error",attrs:{cols:"12",md:"auto"}},[a("b-alert",{attrs:{show:"",variant:"danger"}},[e._v(e._s(e.data.edit.error))])],1)],1):e._e(),e.data.edit.loading||e.data.edit.error?e._e():a("b-row",[a("b-col",{attrs:{md:"4"}},[a("b-row",[a("b-col",{attrs:{md:"12"}},[a("b-form-group",{attrs:{label:"Result element","label-for":"editRecipeResult"}},[a("v-select",{attrs:{id:"editRecipeResult",options:e.data.elements,label:"name"},model:{value:e.data.edit.result,callback:function(t){e.$set(e.data.edit,"result",t)},expression:"data.edit.result"}})],1)],1)],1),e.data.edit.dropdownsCount?e._l(e.data.edit.dropdownsCount,function(t,r){return a("b-row",{key:t,staticClass:"mt-2"},[a("b-col",{attrs:{md:"12"}},[a("b-form-group",{attrs:{"label-for":"editRecipeElements"}},[e._v("Element "+e._s(r+1)),a("v-select",{staticClass:"mt-1",attrs:{id:"editRecipeElements",options:e.data.elements,label:"name"},on:{input:function(t){return e.editRecipeCheckNewDropdown(e.data.edit.recipe[r],r)}},model:{value:e.data.edit.recipe[r],callback:function(t){e.$set(e.data.edit.recipe,r,t)},expression:"data.edit.recipe[index]"}})],1)],1)],1)}):e._e()],2),a("b-col",{attrs:{md:"8"}},[a("b-card",{attrs:{"no-body":""}},[a("b-tabs",{attrs:{card:"",pills:"",vertical:"",small:"","nav-wrapper-class":"w-25"}},e._l(e.data.categories,function(t){return a("b-tab",{key:t._id,attrs:{title:t.name}},e._l(e.data.elements,function(r){return r.category===t.name?a("b-btn",{key:r._id,staticClass:"mr-2 mb-2",attrs:{size:"sm",variant:"outline-success"},on:{click:function(t){return e.data.edit.recipe.push(r)}}},[e._v(e._s(r.name))]):e._e()}),1)}),1)],1)],1)],1)],1),a("b-modal",{ref:"deleteRecipeModal",attrs:{size:"md","hide-header-close":"","no-close-on-backdrop":"","no-close-on-esc":"","ok-title":"Delete","ok-variant":"success","cancel-variant":"danger","hide-header":""},on:{ok:function(t){return e.deleteRecipe()},cancel:function(t){return e.deleteRecipeModalHide()}}},[a("b-row",{staticClass:"justify-content-md-center"},[a("b-col",{attrs:{cols:"12",md:"auto"}},[a("h4",[e._v("Delete recipe"),a("strong",{staticClass:"text-danger"},[e._v(" "+e._s(e.data.delete.name))]),e._v("?")])])],1)],1)],1)},i=[],n=a("3f27"),s=a("63c6"),o=a("1da1"),d=a("bc3a"),c=a.n(d);function l(){return u.apply(this,arguments)}function u(){return u=Object(o["a"])(function*(){try{const t=yield c()({method:"get",url:"/api/recipes"});return t}catch(e){return e.response}}),u.apply(this,arguments)}function p(e,t){return h.apply(this,arguments)}function h(){return h=Object(o["a"])(function*(e,t){try{const r=yield c()({method:"post",url:"/api/recipe/add",data:{recipe:e,result:t}});return r}catch(a){return a.response}}),h.apply(this,arguments)}function b(e,t,a){return m.apply(this,arguments)}function m(){return m=Object(o["a"])(function*(e,t,a){try{const i=yield c()({method:"put",url:"/api/recipe/update",data:{newRecipe:e,newResult:t,recipeId:a}});return i}catch(r){return r.response}}),m.apply(this,arguments)}function f(e){return g.apply(this,arguments)}function g(){return g=Object(o["a"])(function*(e){try{const a=yield c()({method:"delete",url:"/api/recipe/delete",data:{recipeId:e}});return a}catch(t){return t.response}}),g.apply(this,arguments)}var w={name:"Recipes",created(){this.getRecipes()},watch:{$route:"getRecipes"},data(){return{data:{elements:[],categories:[],recipes:[],table:{totalRows:0,loading:!1,error:null,fields:[{key:"result.name",label:"Element",class:"align-middle text-center",sortable:!0},{key:"recipe",label:"Recipe",class:"align-middle text-center",sortable:!0},{key:"action",label:"Action",class:"align-middle text-center",sortable:!1}],pagination:{perPage:10,currentPage:1,pageOptions:[5,10,25,50]},search:null},create:{loading:!1,error:null,dropdownsCount:2,recipe:[],result:null},delete:{loading:!1,error:null,recipeId:null,name:null},edit:{loading:!1,error:null,dropdownsCount:2,recipeId:null,recipe:[],result:null}}}},methods:{getElements(){this.data.table.loading=!0,Object(n["b"])().then(e=>{this.data.table.loading=!1,200===e.status?(this.data.elements=e.data.response,this.data.create.error=null,this.data.edit.error=null):(this.data.create.error=e.data,this.data.edit.error=e.data)})},getCategories(){Object(s["a"])().then(e=>{this.data.create.loading=!1,200===e.status?(this.data.categories=e.data.response,this.data.create.error=null,this.data.edit.error=null):(this.data.create.error=e.data,this.data.edit.error=e.data)})},getRecipes(){this.data.table.loading=!0,l().then(e=>{this.data.table.loading=!1,200===e.status?(this.data.recipes=e.data.response,this.data.table.totalRows=this.data.recipes.length,this.data.table.error=null):this.data.table.error=e.data})},onTableSearch(e){this.data.table.totalRows=e.length,this.data.table.pagination.currentPage=1},createRecipeCheckNewDropdown(e,t){e&&t===this.data.create.dropdownsCount-1?this.data.create.dropdownsCount++:e||t===this.data.create.dropdownsCount-1||(this.data.create.recipe=this.data.create.recipe.filter(e=>e),this.data.create.dropdownsCount--)},editRecipeCheckNewDropdown(e,t){e&&t===this.data.edit.dropdownsCount-1?this.data.edit.dropdownsCount++:e||t===this.data.edit.dropdownsCount-1||(this.data.edit.recipe=this.data.edit.recipe.filter(e=>e),this.data.edit.dropdownsCount--)},createRecipe(e){if(this.data.create.result&&this.data.create.recipe){let e=[];for(let t=0;t<this.data.create.recipe.length;t++)e.push(this.data.create.recipe[t]._id);this.data.create.loading=!0,p(e,this.data.create.result._id).then(e=>{this.data.create.loading=!1,201===e.status?(this.getRecipes(),this.createRecipeModalHide(),this.data.create.error=null):this.data.create.error=e.data})}else e.preventDefault()},editRecipe(e){if(this.data.edit.recipeId&&this.data.edit.result&&this.data.edit.recipe){let e=[];for(let t=0;t<this.data.edit.recipe.length;t++)e.push(this.data.edit.recipe[t]._id);this.data.edit.loading=!0,b(e,this.data.edit.result._id,this.data.edit.recipeId).then(e=>{this.data.edit.loading=!1,200===e.status?(this.getRecipes(),this.editRecipeModalHide(),this.data.edit.error=null):this.data.edit.error=e.data})}else e.preventDefault()},deleteRecipe(e){this.data.delete.loading=!0,f(this.data.delete.recipeId).then(e=>{this.data.delete.loading=!1,200===e.status?(this.getRecipes(),this.data.delete.error=null):this.data.delete.error=e.data})},createRecipeModalShow(){this.$refs.createRecipeModal.show(),this.getElements(),this.getCategories()},editRecipeModalShow(e){this.data.edit.recipeId=e.item._id,this.data.edit.recipe=e.item.recipe,this.data.edit.result=e.item.result,this.data.edit.dropdownsCount=e.item.recipe.length,this.$refs.editRecipeModal.show(),this.getElements(),this.getCategories()},deleteRecipeModalShow(e){this.$refs.deleteRecipeModal.show(),this.data.delete.recipeId=e.item._id,this.data.delete.name=e.item.result.name},createRecipeModalHide(){this.$refs.createRecipeModal.hide(),this.data.create.recipe=[],this.data.create.result=null,this.data.create.dropdownsCount=2},editRecipeModalHide(){this.$refs.editRecipeModal.hide()},deleteRecipeModalHide(){this.$refs.deleteRecipeModal.hide()}}},y=w,R=a("2877"),_=Object(R["a"])(y,r,i,!1,null,null,null);t["default"]=_.exports}}]);
//# sourceMappingURL=Recipes.3f34f7bf.js.map